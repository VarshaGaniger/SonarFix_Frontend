{
    "sourceFile": "src/pages/CodeViewer.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 21,
            "patches": [
                {
                    "date": 1772110404470,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1772111088445,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -387,58 +387,9 @@\n             </button>\r\n            </div>\r\n           </div>\r\n \r\n- <div className=\"editor-body\">\r\n-  <div className=\"code-area\">\r\n-    {fileContent?.lines?.map(line => {\r\n-\r\n-      const activeIssue = issues.find(\r\n-        issue =>\r\n-          issue.line === line.lineNumber &&\r\n-          issue.id === activeIssueId\r\n-      );\r\n-\r\n-      const hasActiveIssue = !!activeIssue;\r\n-\r\n-      return (\r\n-        <React.Fragment key={line.lineNumber}>\r\n-          <div\r\n-            id={`line-${line.lineNumber}`}\r\n-            className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n-          >\r\n-            <span>{line.lineNumber}</span>\r\n-\r\n-            {line.segments.map((segment, idx) => (\r\n-              <span\r\n-                key={idx}\r\n-                className={segment.highlighted ? \"highlight\" : \"\"}\r\n-              >\r\n-                {segment.text}\r\n-              </span>\r\n-            ))}\r\n-          </div>\r\n-\r\n-          {hasActiveIssue && (\r\n-            <div className=\"issue-popup-row\">\r\n-              <div className=\"popup\">\r\n-                <div className=\"popup-icon\">\r\n-                  <AlertCircle size={16} />\r\n-                </div>\r\n-                <div>\r\n-                  <h4>{activeIssue.title}</h4>\r\n-                  <p className=\"popup-sub\">\r\n-                    {activeIssue.severity.toUpperCase()}\r\n-                  </p>\r\n-                  \r\n-                </div>\r\n-              </div>\r\n-            </div>\r\n-          )}\r\n-        </React.Fragment>\r\n-      );\r\n-    })}\r\n-  </div>\r\n+ \r\n </div>\r\n         </section>\r\n \r\n       </main>\r\n"
                },
                {
                    "date": 1772111097515,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -385,12 +385,9 @@\n             <button onClick={handleFullScreen} className=\"icon-btn\">\r\n               <Maximize2 size={18} />\r\n             </button>\r\n            </div>\r\n-          </div>\r\n-\r\n- \r\n-</div>\r\n+          </d\r\n         </section>\r\n \r\n       </main>\r\n     </Box>\r\n"
                },
                {
                    "date": 1772111104200,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -385,9 +385,9 @@\n             <button onClick={handleFullScreen} className=\"icon-btn\">\r\n               <Maximize2 size={18} />\r\n             </button>\r\n            </div>\r\n-          </d\r\n+          </div>\r\n         </section>\r\n \r\n       </main>\r\n     </Box>\r\n"
                },
                {
                    "date": 1772111123493,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -372,24 +372,80 @@\n \r\n         {/* CENTER PANEL */}\r\n         <section className=\"center-panel\" ref={editorRef}>\r\n \r\n-          <div className=\"editor-header\">\r\n-            <div className=\"editor-title\">\r\n-              {selectedFile || \"Select a file\"}\r\n-            </div>\r\n-            <div className=\"editor-actions\">\r\n-              <button onClick={handleCopy} className=\"icon-btn\">\r\n-              <Copy size={18} />\r\n-            </button>\r\n+  {activeIssueId ? (\r\n+    <>\r\n+      <div className=\"issue-tabs\">\r\n+        <button\r\n+          className={activeTab === \"where\" ? \"active\" : \"\"}\r\n+          onClick={() => setActiveTab(\"where\")}\r\n+        >\r\n+          Where is the issue?\r\n+        </button>\r\n \r\n-            <button onClick={handleFullScreen} className=\"icon-btn\">\r\n-              <Maximize2 size={18} />\r\n-            </button>\r\n-           </div>\r\n+        <button\r\n+          className={activeTab === \"why\" ? \"active\" : \"\"}\r\n+          onClick={() => setActiveTab(\"why\")}\r\n+        >\r\n+          Why is this an issue?\r\n+        </button>\r\n+\r\n+        <button\r\n+          className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n+          onClick={() => setActiveTab(\"fix\")}\r\n+        >\r\n+          How can I fix it?\r\n+        </button>\r\n+\r\n+        <button\r\n+          className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n+          onClick={() => setActiveTab(\"activity\")}\r\n+        >\r\n+          Activity\r\n+        </button>\r\n+      </div>\r\n+\r\n+      <div className=\"tab-content\">\r\n+\r\n+        {activeTab === \"where\" && (\r\n+          <div className=\"editor-body\">\r\n+            {renderCodeArea()}\r\n           </div>\r\n-        </section>\r\n+        )}\r\n \r\n+        {activeTab === \"why\" && (\r\n+          <div className=\"why-panel\">\r\n+            <h3>{getActiveIssue()?.title}</h3>\r\n+            <p>{getActiveIssue()?.description}</p>\r\n+          </div>\r\n+        )}\r\n+\r\n+        {activeTab === \"fix\" && (\r\n+          <div className=\"fix-panel\">\r\n+            <p>\r\n+              Refactor this code to avoid hardcoded values.\r\n+              Move constants to configuration properties or environment variables.\r\n+            </p>\r\n+          </div>\r\n+        )}\r\n+\r\n+        {activeTab === \"activity\" && (\r\n+          <div className=\"activity-panel\">\r\n+            <p>No activity yet.</p>\r\n+          </div>\r\n+        )}\r\n+\r\n+      </div>\r\n+    </>\r\n+  ) : (\r\n+    <div className=\"empty-state\">\r\n+      Select an issue to view details.\r\n+    </div>\r\n+  )}\r\n+\r\n+</section>\r\n+\r\n       </main>\r\n     </Box>\r\n   );\r\n };\r\n"
                },
                {
                    "date": 1772111220588,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,8 +18,9 @@\n import { useLocation } from \"react-router-dom\";\r\n import axios from \"axios\";\r\n import \"./CodeViewer.css\";\r\n \r\n+\r\n const CodeViewer = () => {\r\n \r\n   const location = useLocation();\r\n   const projectKey = location.state?.projectKey;\r\n"
                },
                {
                    "date": 1772111250755,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,8 +19,9 @@\n import axios from \"axios\";\r\n import \"./CodeViewer.css\";\r\n \r\n \r\n+\r\n const CodeViewer = () => {\r\n \r\n   const location = useLocation();\r\n   const projectKey = location.state?.projectKey;\r\n@@ -233,10 +234,41 @@\n   } else {\r\n     document.exitFullscreen();\r\n   }\r\n };\r\n+const getActiveIssue = () =>\r\n+  issues.find(i => i.id === activeIssueId);\r\n \r\n+const renderCodeArea = () => {\r\n+  const activeIssue = getActiveIssue();\r\n+\r\n   return (\r\n+    <div className=\"code-area\">\r\n+      {fileContent?.lines?.map(line => {\r\n+        const isHighlighted =\r\n+          activeIssue && line.lineNumber === activeIssue.line;\r\n+\r\n+        return (\r\n+          <div\r\n+            key={line.lineNumber}\r\n+            className={`code-line ${isHighlighted ? \"highlight-line\" : \"\"}`}\r\n+          >\r\n+            <span className=\"line-number\">\r\n+              {line.lineNumber}\r\n+            </span>\r\n+\r\n+            {line.segments.map((segment, idx) => (\r\n+              <span key={idx}>\r\n+                {segment.text}\r\n+              </span>\r\n+            ))}\r\n+          </div>\r\n+        );\r\n+      })}\r\n+    </div>\r\n+  );\r\n+};\r\n+  return (\r\n     <Box className=\"code-viewer-page\">\r\n \r\n       <Box className=\"code-viewer-nav\">\r\n         <Breadcrumbs separator={<ChevronRight size={14} color=\"#94a3b8\" />}>\r\n"
                },
                {
                    "date": 1772111300577,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,8 +24,9 @@\n const CodeViewer = () => {\r\n \r\n   const location = useLocation();\r\n   const projectKey = location.state?.projectKey;\r\n+  const [activeTab, setActiveTab] = useState(\"where\");\r\n   const initialIssue = location.state?.issue;\r\n   const editorRef = useRef(null);\r\n   const [openFiles, setOpenFiles] = useState({});\r\n   const [autoFixOnly, setAutoFixOnly] = useState(false);\r\n@@ -266,8 +267,9 @@\n       })}\r\n     </div>\r\n   );\r\n };\r\n+\r\n   return (\r\n     <Box className=\"code-viewer-page\">\r\n \r\n       <Box className=\"code-viewer-nav\">\r\n"
                },
                {
                    "date": 1772111573047,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -405,80 +405,113 @@\n           </div>\r\n         </aside>\r\n \r\n         {/* CENTER PANEL */}\r\n-        <section className=\"center-panel\" ref={editorRef}>\r\n+       <section className=\"center-panel\" ref={editorRef}>\r\n+  <div className=\"editor-body\">\r\n+    <div className=\"code-area\">\r\n+      {fileContent?.lines?.map(line => {\r\n \r\n-  {activeIssueId ? (\r\n-    <>\r\n-      <div className=\"issue-tabs\">\r\n-        <button\r\n-          className={activeTab === \"where\" ? \"active\" : \"\"}\r\n-          onClick={() => setActiveTab(\"where\")}\r\n-        >\r\n-          Where is the issue?\r\n-        </button>\r\n+        const activeIssue = issues.find(\r\n+          issue =>\r\n+            issue.line === line.lineNumber &&\r\n+            issue.id === activeIssueId\r\n+        );\r\n \r\n-        <button\r\n-          className={activeTab === \"why\" ? \"active\" : \"\"}\r\n-          onClick={() => setActiveTab(\"why\")}\r\n-        >\r\n-          Why is this an issue?\r\n-        </button>\r\n+        const hasActiveIssue = !!activeIssue;\r\n \r\n-        <button\r\n-          className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n-          onClick={() => setActiveTab(\"fix\")}\r\n-        >\r\n-          How can I fix it?\r\n-        </button>\r\n+        return (\r\n+          <React.Fragment key={line.lineNumber}>\r\n+            \r\n+            <div\r\n+              id={`line-${line.lineNumber}`}\r\n+              className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n+            >\r\n+              <span className=\"line-number\">\r\n+                {line.lineNumber}\r\n+              </span>\r\n \r\n-        <button\r\n-          className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n-          onClick={() => setActiveTab(\"activity\")}\r\n-        >\r\n-          Activity\r\n-        </button>\r\n-      </div>\r\n+              {line.segments.map((segment, idx) => (\r\n+                <span key={idx}>\r\n+                  {segment.text}\r\n+                </span>\r\n+              ))}\r\n+            </div>\r\n \r\n-      <div className=\"tab-content\">\r\n+            {hasActiveIssue && (\r\n+              <div className=\"issue-inline-panel\">\r\n \r\n-        {activeTab === \"where\" && (\r\n-          <div className=\"editor-body\">\r\n-            {renderCodeArea()}\r\n-          </div>\r\n-        )}\r\n+                <div className=\"issue-tabs\">\r\n+                  <button\r\n+                    className={activeTab === \"where\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"where\")}\r\n+                  >\r\n+                    Where is the issue?\r\n+                  </button>\r\n \r\n-        {activeTab === \"why\" && (\r\n-          <div className=\"why-panel\">\r\n-            <h3>{getActiveIssue()?.title}</h3>\r\n-            <p>{getActiveIssue()?.description}</p>\r\n-          </div>\r\n-        )}\r\n+                  <button\r\n+                    className={activeTab === \"why\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"why\")}\r\n+                  >\r\n+                    Why is this an issue?\r\n+                  </button>\r\n \r\n-        {activeTab === \"fix\" && (\r\n-          <div className=\"fix-panel\">\r\n-            <p>\r\n-              Refactor this code to avoid hardcoded values.\r\n-              Move constants to configuration properties or environment variables.\r\n-            </p>\r\n-          </div>\r\n-        )}\r\n+                  <button\r\n+                    className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"fix\")}\r\n+                  >\r\n+                    How can I fix it?\r\n+                  </button>\r\n \r\n-        {activeTab === \"activity\" && (\r\n-          <div className=\"activity-panel\">\r\n-            <p>No activity yet.</p>\r\n-          </div>\r\n-        )}\r\n+                  <button\r\n+                    className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"activity\")}\r\n+                  >\r\n+                    Activity\r\n+                  </button>\r\n+                </div>\r\n \r\n-      </div>\r\n-    </>\r\n-  ) : (\r\n-    <div className=\"empty-state\">\r\n-      Select an issue to view details.\r\n+                <div className=\"issue-tab-content\">\r\n+\r\n+                  {activeTab === \"where\" && (\r\n+                    <div>\r\n+                      <p><strong>File:</strong> {activeIssue.file}</p>\r\n+                      <p><strong>Line:</strong> {activeIssue.line}</p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                  {activeTab === \"why\" && (\r\n+                    <div>\r\n+                      <h4>{activeIssue.rule}</h4>\r\n+                      <p>{activeIssue.description}</p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                  {activeTab === \"fix\" && (\r\n+                    <div>\r\n+                      <p>\r\n+                        Refactor this code to avoid hardcoded values.\r\n+                        Move constants to configuration or environment variables.\r\n+                      </p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                  {activeTab === \"activity\" && (\r\n+                    <div>\r\n+                      <p>No activity yet.</p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                </div>\r\n+\r\n+              </div>\r\n+            )}\r\n+\r\n+          </React.Fragment>\r\n+        );\r\n+      })}\r\n     </div>\r\n-  )}\r\n-\r\n+  </div>\r\n </section>\r\n \r\n       </main>\r\n     </Box>\r\n"
                },
                {
                    "date": 1772111609794,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,15 +18,12 @@\n import { useLocation } from \"react-router-dom\";\r\n import axios from \"axios\";\r\n import \"./CodeViewer.css\";\r\n \r\n-\r\n-\r\n const CodeViewer = () => {\r\n \r\n   const location = useLocation();\r\n   const projectKey = location.state?.projectKey;\r\n-  const [activeTab, setActiveTab] = useState(\"where\");\r\n   const initialIssue = location.state?.issue;\r\n   const editorRef = useRef(null);\r\n   const [openFiles, setOpenFiles] = useState({});\r\n   const [autoFixOnly, setAutoFixOnly] = useState(false);\r\n@@ -235,42 +232,10 @@\n   } else {\r\n     document.exitFullscreen();\r\n   }\r\n };\r\n-const getActiveIssue = () =>\r\n-  issues.find(i => i.id === activeIssueId);\r\n \r\n-const renderCodeArea = () => {\r\n-  const activeIssue = getActiveIssue();\r\n-\r\n   return (\r\n-    <div className=\"code-area\">\r\n-      {fileContent?.lines?.map(line => {\r\n-        const isHighlighted =\r\n-          activeIssue && line.lineNumber === activeIssue.line;\r\n-\r\n-        return (\r\n-          <div\r\n-            key={line.lineNumber}\r\n-            className={`code-line ${isHighlighted ? \"highlight-line\" : \"\"}`}\r\n-          >\r\n-            <span className=\"line-number\">\r\n-              {line.lineNumber}\r\n-            </span>\r\n-\r\n-            {line.segments.map((segment, idx) => (\r\n-              <span key={idx}>\r\n-                {segment.text}\r\n-              </span>\r\n-            ))}\r\n-          </div>\r\n-        );\r\n-      })}\r\n-    </div>\r\n-  );\r\n-};\r\n-\r\n-  return (\r\n     <Box className=\"code-viewer-page\">\r\n \r\n       <Box className=\"code-viewer-nav\">\r\n         <Breadcrumbs separator={<ChevronRight size={14} color=\"#94a3b8\" />}>\r\n@@ -305,12 +270,12 @@\n               </div>\r\n \r\n               <div className=\"btn-row\">\r\n                 <button className=\"btn-outline\" onClick={applySelected}>\r\n-                  Fix Selected\r\n+                  Auto-Fix Selected\r\n                 </button>\r\n                 <button className=\"btn-primary\" onClick={applyAll}>\r\n-                  Fix All\r\n+                  Auto-Fix All\r\n                 </button>\r\n               </div>\r\n             </div>\r\n           </div>\r\n@@ -405,114 +370,79 @@\n           </div>\r\n         </aside>\r\n \r\n         {/* CENTER PANEL */}\r\n-       <section className=\"center-panel\" ref={editorRef}>\r\n-  <div className=\"editor-body\">\r\n-    <div className=\"code-area\">\r\n-      {fileContent?.lines?.map(line => {\r\n+        <section className=\"center-panel\" ref={editorRef}>\r\n \r\n-        const activeIssue = issues.find(\r\n-          issue =>\r\n-            issue.line === line.lineNumber &&\r\n-            issue.id === activeIssueId\r\n-        );\r\n-\r\n-        const hasActiveIssue = !!activeIssue;\r\n-\r\n-        return (\r\n-          <React.Fragment key={line.lineNumber}>\r\n-            \r\n-            <div\r\n-              id={`line-${line.lineNumber}`}\r\n-              className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n-            >\r\n-              <span className=\"line-number\">\r\n-                {line.lineNumber}\r\n-              </span>\r\n-\r\n-              {line.segments.map((segment, idx) => (\r\n-                <span key={idx}>\r\n-                  {segment.text}\r\n-                </span>\r\n-              ))}\r\n+          <div className=\"editor-header\">\r\n+            <div className=\"editor-title\">\r\n+              {selectedFile || \"Select a file\"}\r\n             </div>\r\n+            <div className=\"editor-actions\">\r\n+              <button onClick={handleCopy} className=\"icon-btn\">\r\n+              <Copy size={18} />\r\n+            </button>\r\n \r\n-            {hasActiveIssue && (\r\n-              <div className=\"issue-inline-panel\">\r\n+            <button onClick={handleFullScreen} className=\"icon-btn\">\r\n+              <Maximize2 size={18} />\r\n+            </button>\r\n+           </div>\r\n+          </div>\r\n \r\n-                <div className=\"issue-tabs\">\r\n-                  <button\r\n-                    className={activeTab === \"where\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"where\")}\r\n-                  >\r\n-                    Where is the issue?\r\n-                  </button>\r\n+ <div className=\"editor-body\">\r\n+  <div className=\"code-area\">\r\n+    {fileContent?.lines?.map(line => {\r\n \r\n-                  <button\r\n-                    className={activeTab === \"why\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"why\")}\r\n-                  >\r\n-                    Why is this an issue?\r\n-                  </button>\r\n+      const activeIssue = issues.find(\r\n+        issue =>\r\n+          issue.line === line.lineNumber &&\r\n+          issue.id === activeIssueId\r\n+      );\r\n \r\n-                  <button\r\n-                    className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"fix\")}\r\n-                  >\r\n-                    How can I fix it?\r\n-                  </button>\r\n+      const hasActiveIssue = !!activeIssue;\r\n \r\n-                  <button\r\n-                    className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"activity\")}\r\n-                  >\r\n-                    Activity\r\n-                  </button>\r\n-                </div>\r\n+      return (\r\n+        <React.Fragment key={line.lineNumber}>\r\n+          <div\r\n+            id={`line-${line.lineNumber}`}\r\n+            className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n+          >\r\n+            <span>{line.lineNumber}</span>\r\n \r\n-                <div className=\"issue-tab-content\">\r\n+            {line.segments.map((segment, idx) => (\r\n+              <span\r\n+                key={idx}\r\n+                className={segment.highlighted ? \"highlight\" : \"\"}\r\n+              >\r\n+                {segment.text}\r\n+              </span>\r\n+            ))}\r\n+          </div>\r\n \r\n-                  {activeTab === \"where\" && (\r\n-                    <div>\r\n-                      <p><strong>File:</strong> {activeIssue.file}</p>\r\n-                      <p><strong>Line:</strong> {activeIssue.line}</p>\r\n-                    </div>\r\n-                  )}\r\n-\r\n-                  {activeTab === \"why\" && (\r\n-                    <div>\r\n-                      <h4>{activeIssue.rule}</h4>\r\n-                      <p>{activeIssue.description}</p>\r\n-                    </div>\r\n-                  )}\r\n-\r\n-                  {activeTab === \"fix\" && (\r\n-                    <div>\r\n-                      <p>\r\n-                        Refactor this code to avoid hardcoded values.\r\n-                        Move constants to configuration or environment variables.\r\n-                      </p>\r\n-                    </div>\r\n-                  )}\r\n-\r\n-                  {activeTab === \"activity\" && (\r\n-                    <div>\r\n-                      <p>No activity yet.</p>\r\n-                    </div>\r\n-                  )}\r\n-\r\n+          {hasActiveIssue && (\r\n+            <div className=\"issue-popup-row\">\r\n+              <div className=\"popup\">\r\n+                <div className=\"popup-icon\">\r\n+                  <AlertCircle size={16} />\r\n                 </div>\r\n-\r\n+                <div>\r\n+                  <h4>{activeIssue.rule}</h4>\r\n+                  <p className=\"popup-sub\">\r\n+                    {activeIssue.severity.toUpperCase()}\r\n+                  </p>\r\n+                  <p className=\"popup-text\">\r\n+                    {activeIssue.description}\r\n+                  </p>\r\n+                </div>\r\n               </div>\r\n-            )}\r\n-\r\n-          </React.Fragment>\r\n-        );\r\n-      })}\r\n-    </div>\r\n+            </div>\r\n+          )}\r\n+        </React.Fragment>\r\n+      );\r\n+    })}\r\n   </div>\r\n-</section>\r\n+</div>\r\n+        </section>\r\n \r\n       </main>\r\n     </Box>\r\n   );\r\n"
                },
                {
                    "date": 1772111666502,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,521 @@\n+import React, { useState, useEffect, useRef } from \"react\";\r\n+import {\r\n+  Box,\r\n+  Typography,\r\n+  Breadcrumbs,\r\n+  Link\r\n+} from \"@mui/material\";\r\n+import {\r\n+  ChevronRight,\r\n+  ChevronDown,\r\n+  FileText,\r\n+  Copy,\r\n+  Maximize2,\r\n+  AlertCircle\r\n+} from \"lucide-react\";\r\n+import { toast } from \"react-toastify\";\r\n+\r\n+import { useLocation } from \"react-router-dom\";\r\n+import axios from \"axios\";\r\n+import \"./CodeViewer.css\";\r\n+\r\n+\r\n+\r\n+const CodeViewer = () => {\r\n+\r\n+  const location = useLocation();\r\n+  const projectKey = location.state?.projectKey;\r\n+  const [activeTab, setActiveTab] = useState(\"where\");\r\n+  const initialIssue = location.state?.issue;\r\n+  const editorRef = useRef(null);\r\n+  const [openFiles, setOpenFiles] = useState({});\r\n+  const [autoFixOnly, setAutoFixOnly] = useState(false);\r\n+  const [issues, setIssues] = useState([]);\r\n+  const [fileContent, setFileContent] = useState(null);\r\n+  const [selectedFile, setSelectedFile] = useState(null);\r\n+  const [activeIssueId, setActiveIssueId] = useState(null);\r\n+  const [loading, setLoading] = useState(false);\r\n+\r\n+  /* ================= FETCH ISSUES ================= */\r\n+\r\n+  useEffect(() => {\r\n+    if (!projectKey) return;\r\n+    fetchIssues();\r\n+  }, [autoFixOnly, projectKey]);\r\n+\r\n+    useEffect(() => {\r\n+    if (!initialIssue || issues.length === 0) return;\r\n+\r\n+    const matchedIssue = issues.find(i => i.id === initialIssue.key);\r\n+    if (!matchedIssue) return;\r\n+\r\n+    openFile(matchedIssue.file);\r\n+    setActiveIssueId(matchedIssue.id);\r\n+\r\n+    setTimeout(() => {\r\n+      const el = document.getElementById(`line-${matchedIssue.line}`);\r\n+      if (el) {\r\n+        el.scrollIntoView({\r\n+          behavior: \"smooth\",\r\n+          block: \"center\"\r\n+        });\r\n+      }\r\n+    }, 400);\r\n+\r\n+  }, [issues, initialIssue]);\r\n+  \r\n+  const fetchIssues = async () => {\r\n+    try {\r\n+      setLoading(true);\r\n+\r\n+      const response = await axios.get(\r\n+        `http://localhost:8080/api/scan/${projectKey}/issues`,\r\n+        {\r\n+          params: {\r\n+            autoFixOnly,\r\n+            page: 1,\r\n+            pageSize: 200\r\n+          }\r\n+        }\r\n+      );\r\n+\r\n+      const backendIssues =\r\n+        response.data.content?.flatMap(group => group.issues) || [];\r\n+\r\n+const mapped = backendIssues.map(issue => ({\r\n+  id: issue.key,\r\n+  file: issue.filePath,\r\n+  title: issue.message,        // ✅ show actual message\r\n+  rule: issue.rule,            // keep rule separately\r\n+  description: issue.description,\r\n+  severity: issue.severity?.toLowerCase() || \"minor\",\r\n+  line: issue.line,\r\n+  autoFix: issue.autoFixable,\r\n+  selected: false\r\n+}));\r\n+      setIssues(mapped);\r\n+\r\n+      const fileMap = {};\r\n+      mapped.forEach(i => fileMap[i.file] = true);\r\n+      setOpenFiles(fileMap);\r\n+\r\n+    } catch (err) {\r\n+      console.error(\"Error fetching issues:\", err);\r\n+    } finally {\r\n+      setLoading(false);\r\n+    }\r\n+  };\r\n+\r\n+  const toggleIssue = (id) => {\r\n+  setIssues(prev =>\r\n+    prev.map(issue =>\r\n+      issue.id === id\r\n+        ? { ...issue, selected: !issue.selected }\r\n+        : issue\r\n+    )\r\n+  );\r\n+};\r\n+\r\n+  /* ================= FETCH FILE ================= */\r\n+\r\n+  const openFile = async (filePath) => {\r\n+    try {\r\n+      const response = await axios.get(\r\n+        `http://localhost:8080/api/files/${projectKey}`,\r\n+        { params: { filePath } }\r\n+      );\r\n+\r\n+      setFileContent(response.data);\r\n+      setSelectedFile(filePath);\r\n+\r\n+    } catch (err) {\r\n+      console.error(\"Failed to load file\", err);\r\n+    }\r\n+  };\r\n+\r\n+  /* ================= GROUP FILES ================= */\r\n+\r\n+  const files = [...new Set(issues.map(i => i.file))];\r\n+\r\n+  const getFileIssues = (filePath) =>\r\n+    issues.filter(issue => issue.file === filePath);\r\n+\r\n+  const isFileFullySelected = (filePath) => {\r\n+    const fileIssues = getFileIssues(filePath);\r\n+    if (fileIssues.length === 0) return false;\r\n+    return fileIssues.every(i => i.selected);\r\n+  };\r\n+\r\n+  const toggleFileSelectAll = (filePath) => {\r\n+    const fileIssues = getFileIssues(filePath);\r\n+    const allSelected = fileIssues.every(i => i.selected);\r\n+\r\n+    setIssues(prev =>\r\n+      prev.map(issue =>\r\n+        issue.file === filePath\r\n+          ? { ...issue, selected: !allSelected }\r\n+          : issue\r\n+      )\r\n+    );\r\n+  };\r\n+\r\n+  const toggleFileExpand = (filePath) => {\r\n+    setOpenFiles(prev => ({\r\n+      ...prev,\r\n+      [filePath]: !prev[filePath]\r\n+    }));\r\n+  };\r\n+\r\n+  /* ================= AUTO FIX ================= */\r\n+\r\n+  const applySelected = async () => {\r\n+    const selectedIssues = issues.filter(i => i.selected);\r\n+    if (selectedIssues.length === 0) return toast.error(\"No issues selected\");\r\n+\r\n+    try {\r\n+      await axios.post(\"http://localhost:8080/api/fix/apply\", {\r\n+        issueKeys: selectedIssues.map(i => i.id),\r\n+        projectKey\r\n+      });\r\n+      fetchIssues();\r\n+    } catch (err) {\r\n+      console.error(\"Auto-fix failed\", err);\r\n+    }\r\n+  };\r\n+\r\n+  const applyAll = async () => {\r\n+    if (issues.length === 0) return toast.error(\"No issues to apply\");\r\n+\r\n+    try {\r\n+      await axios.post(\"http://localhost:8080/api/fix/apply\", {\r\n+        issueKeys: issues.map(i => i.id),\r\n+        projectKey\r\n+      });\r\n+      fetchIssues();\r\n+    } catch (err) {\r\n+      console.error(\"Auto-fix all failed\", err);\r\n+    }\r\n+  };\r\n+const maskFilePath = (fullPath) => {\r\n+  if (!fullPath) return \"\";\r\n+\r\n+  const parts = fullPath.split(\"/\");\r\n+\r\n+  if (parts.length <= 3) return fullPath; \r\n+\r\n+  const first = parts[0]; \r\n+  const lastFolder = parts[parts.length - 2];\r\n+  const fileName = parts[parts.length - 1];\r\n+\r\n+  return `${first}/../${lastFolder}/${fileName}`;\r\n+};\r\n+\r\n+  const handleCopy = async () => {\r\n+  if (!fileContent?.lines) return;\r\n+\r\n+  const fullText = fileContent.lines\r\n+    .map(line =>\r\n+      line.segments.map(segment => segment.text).join(\"\")\r\n+    )\r\n+    .join(\"\\n\");\r\n+\r\n+  try {\r\n+    await navigator.clipboard.writeText(fullText);\r\n+    toast.success(\"Copied to clipboard\");\r\n+  } catch (err) {\r\n+    toast.error(\"Copy failed\", err);\r\n+  }\r\n+};\r\n+\r\n+const handleFullScreen = () => {\r\n+  if (!editorRef.current) return;\r\n+\r\n+  if (!document.fullscreenElement) {\r\n+    editorRef.current.requestFullscreen();\r\n+  } else {\r\n+    document.exitFullscreen();\r\n+  }\r\n+};\r\n+const getActiveIssue = () =>\r\n+  issues.find(i => i.id === activeIssueId);\r\n+\r\n+const renderCodeArea = () => {\r\n+  const activeIssue = getActiveIssue();\r\n+\r\n+  return (\r\n+    <div className=\"code-area\">\r\n+      {fileContent?.lines?.map(line => {\r\n+        const isHighlighted =\r\n+          activeIssue && line.lineNumber === activeIssue.line;\r\n+\r\n+        return (\r\n+          <div\r\n+            key={line.lineNumber}\r\n+            className={`code-line ${isHighlighted ? \"highlight-line\" : \"\"}`}\r\n+          >\r\n+            <span className=\"line-number\">\r\n+              {line.lineNumber}\r\n+            </span>\r\n+\r\n+            {line.segments.map((segment, idx) => (\r\n+              <span key={idx}>\r\n+                {segment.text}\r\n+              </span>\r\n+            ))}\r\n+          </div>\r\n+        );\r\n+      })}\r\n+    </div>\r\n+  );\r\n+};\r\n+\r\n+  return (\r\n+    <Box className=\"code-viewer-page\">\r\n+\r\n+      <Box className=\"code-viewer-nav\">\r\n+        <Breadcrumbs separator={<ChevronRight size={14} color=\"#94a3b8\" />}>\r\n+          <Link underline=\"hover\" color=\"#64748b\">Projects</Link>\r\n+          <Link underline=\"hover\" color=\"#64748b\">{projectKey}</Link>\r\n+          <Typography sx={{ fontSize: \"13px\", fontWeight: 600 }}>\r\n+            Code Viewer\r\n+          </Typography>\r\n+        </Breadcrumbs>\r\n+      </Box>\r\n+\r\n+      <main className=\"layout\">\r\n+\r\n+        {/* LEFT PANEL */}\r\n+        <aside className=\"left-panel\">\r\n+\r\n+          <div className=\"left-header\">\r\n+            <div className=\"left-title\">\r\n+              <h3>TOTAL ISSUES</h3>\r\n+              <span className=\"badge\">{issues.length} TOTAL</span>\r\n+            </div>\r\n+\r\n+            <div className=\"controls\">\r\n+              <div className=\"toggle-box\">\r\n+                <span>Auto-Fixable Only</span>\r\n+                <div\r\n+                  className={`toggle ${autoFixOnly ? \"active\" : \"\"}`}\r\n+                  onClick={() => setAutoFixOnly(prev => !prev)}\r\n+                >\r\n+                  <div className=\"toggle-dot\"></div>\r\n+                </div>\r\n+              </div>\r\n+\r\n+              <div className=\"btn-row\">\r\n+                <button className=\"btn-outline\" onClick={applySelected}>\r\n+                  Fix Selected\r\n+                </button>\r\n+                <button className=\"btn-primary\" onClick={applyAll}>\r\n+                  Fix All\r\n+                </button>\r\n+              </div>\r\n+            </div>\r\n+          </div>\r\n+\r\n+          <div className=\"issue-list\">\r\n+            {files.map(filePath => (\r\n+              <div className=\"file-group\" key={filePath}>\r\n+\r\n+                <div\r\n+                  className={`file-header ${selectedFile === filePath ? \"selected-file\" : \"\"}`}\r\n+                  onClick={() => {\r\n+                    if (selectedFile !== filePath) {\r\n+                      openFile(filePath);\r\n+                    }\r\n+                  }}\r\n+                >\r\n+                  <input\r\n+                    type=\"checkbox\"\r\n+                    checked={isFileFullySelected(filePath)}\r\n+                    onClick={(e) => e.stopPropagation()}\r\n+                    onChange={() => toggleFileSelectAll(filePath)}\r\n+                  />\r\n+\r\n+                  <span\r\n+                    onClick={(e) => {\r\n+                      e.stopPropagation();\r\n+                      toggleFileExpand(filePath);\r\n+                    }}\r\n+                  >\r\n+                    {openFiles[filePath] ? (\r\n+                      <ChevronDown size={16} />\r\n+                    ) : (\r\n+                      <ChevronRight size={16} />\r\n+                    )}\r\n+                  </span>\r\n+\r\n+                  <FileText size={18} />\r\n+                 <span className=\"file-name\">{maskFilePath(filePath)}</span>\r\n+                </div>\r\n+\r\n+            {openFiles[filePath] &&\r\n+  getFileIssues(filePath).map(issue => (\r\n+    <div\r\n+      key={issue.id}\r\n+      className={`issue-item ${issue.selected ? \"active\" : \"\"}`}\r\n+      onClick={() => {\r\n+        openFile(issue.file);\r\n+\r\n+        setActiveIssueId(prev =>\r\n+          prev === issue.id ? null : issue.id\r\n+        );\r\n+\r\n+        setTimeout(() => {\r\n+          const el = document.getElementById(`line-${issue.line}`);\r\n+          if (el) {\r\n+            el.scrollIntoView({\r\n+              behavior: \"smooth\",\r\n+              block: \"center\"\r\n+            });\r\n+          }\r\n+        }, 300);\r\n+      }}\r\n+    >\r\n+\r\n+      \r\n+    <input type=\"checkbox\" checked={issue.selected}\r\n+      onChange={(e) => {\r\n+      e.stopPropagation();\r\n+      toggleIssue(issue.id);\r\n+    }}\r\n+    onClick={(e) => e.stopPropagation()}/>\r\n+      <div className=\"issue-content\">\r\n+        <div className=\"issue-top\">\r\n+          <h4>{issue.message}</h4>\r\n+          {issue.autoFix && <span className=\"auto\">AUTO</span>}\r\n+        </div>\r\n+\r\n+        <p>{issue.title}</p>\r\n+\r\n+        <div className=\"issue-meta\">\r\n+          <span className={issue.severity}>\r\n+            {issue.severity.toUpperCase()}\r\n+          </span>\r\n+          <span className=\"line\">Line {issue.line}</span>\r\n+        </div>\r\n+      </div>\r\n+\r\n+    </div>\r\n+))}\r\n+              </div>\r\n+            ))}\r\n+          </div>\r\n+        </aside>\r\n+\r\n+        {/* CENTER PANEL */}\r\n+       <section className=\"center-panel\" ref={editorRef}>\r\n+  <div className=\"editor-body\">\r\n+    <div className=\"code-area\">\r\n+      {fileContent?.lines?.map(line => {\r\n+\r\n+        const activeIssue = issues.find(\r\n+          issue =>\r\n+            issue.line === line.lineNumber &&\r\n+            issue.id === activeIssueId\r\n+        );\r\n+\r\n+        const hasActiveIssue = !!activeIssue;\r\n+\r\n+        return (\r\n+          <React.Fragment key={line.lineNumber}>\r\n+            \r\n+            <div\r\n+              id={`line-${line.lineNumber}`}\r\n+              className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n+            >\r\n+              <span className=\"line-number\">\r\n+                {line.lineNumber}\r\n+              </span>\r\n+\r\n+              {line.segments.map((segment, idx) => (\r\n+                <span key={idx}>\r\n+                  {segment.text}\r\n+                </span>\r\n+              ))}\r\n+            </div>\r\n+\r\n+            {hasActiveIssue && (\r\n+              <div className=\"issue-inline-panel\">\r\n+\r\n+                <div className=\"issue-tabs\">\r\n+                  <button\r\n+                    className={activeTab === \"where\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"where\")}\r\n+                  >\r\n+                    Where is the issue?\r\n+                  </button>\r\n+\r\n+                  <button\r\n+                    className={activeTab === \"why\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"why\")}\r\n+                  >\r\n+                    Why is this an issue?\r\n+                  </button>\r\n+\r\n+                  <button\r\n+                    className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"fix\")}\r\n+                  >\r\n+                    How can I fix it?\r\n+                  </button>\r\n+\r\n+                  <button\r\n+                    className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"activity\")}\r\n+                  >\r\n+                    Activity\r\n+                  </button>\r\n+                </div>\r\n+\r\n+                <div className=\"issue-tab-content\">\r\n+\r\n+                  {activeTab === \"where\" && (\r\n+                    <div>\r\n+                      <p><strong>File:</strong> {activeIssue.file}</p>\r\n+                      <p><strong>Line:</strong> {activeIssue.line}</p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                  {activeTab === \"why\" && (\r\n+                    <div>\r\n+                      <h4>{activeIssue.rule}</h4>\r\n+                      <p>{activeIssue.description}</p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                  {activeTab === \"fix\" && (\r\n+                    <div>\r\n+                      <p>\r\n+                        Refactor this code to avoid hardcoded values.\r\n+                        Move constants to configuration or environment variables.\r\n+                      </p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                  {activeTab === \"activity\" && (\r\n+                    <div>\r\n+                      <p>No activity yet.</p>\r\n+                    </div>\r\n+                  )}\r\n+\r\n+                </div>\r\n+\r\n+              </div>\r\n+            )}\r\n+\r\n+          </React.Fragment>\r\n+        );\r\n+      })}\r\n+    </div>\r\n+  </div>\r\n+</section>\r\n+\r\n+      </main>\r\n+    </Box>\r\n+  );\r\n+};\r\n+\r\n+export default CodeViewer;\r\n"
                },
                {
                    "date": 1772111848969,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -405,9 +405,9 @@\n           </div>\r\n         </aside>\r\n \r\n         {/* CENTER PANEL */}\r\n-       <section className=\"center-panel\" ref={editorRef}>\r\n+<section className=\"center-panel\" ref={editorRef}>\r\n   <div className=\"editor-body\">\r\n     <div className=\"code-area\">\r\n       {fileContent?.lines?.map(line => {\r\n \r\n@@ -420,9 +420,10 @@\n         const hasActiveIssue = !!activeIssue;\r\n \r\n         return (\r\n           <React.Fragment key={line.lineNumber}>\r\n-            \r\n+\r\n+            {/* CODE LINE */}\r\n             <div\r\n               id={`line-${line.lineNumber}`}\r\n               className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n             >\r\n@@ -430,80 +431,44 @@\n                 {line.lineNumber}\r\n               </span>\r\n \r\n               {line.segments.map((segment, idx) => (\r\n-                <span key={idx}>\r\n+                <span\r\n+                  key={idx}\r\n+                  className={segment.highlighted ? \"highlight\" : \"\"}\r\n+                >\r\n                   {segment.text}\r\n                 </span>\r\n               ))}\r\n             </div>\r\n \r\n+            {/* SONAR STYLE POPUP */}\r\n             {hasActiveIssue && (\r\n-              <div className=\"issue-inline-panel\">\r\n+              <div className=\"issue-popup-row\">\r\n+                <div className=\"sonar-card\">\r\n \r\n-                <div className=\"issue-tabs\">\r\n-                  <button\r\n-                    className={activeTab === \"where\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"where\")}\r\n-                  >\r\n-                    Where is the issue?\r\n-                  </button>\r\n+                  <div className=\"sonar-header\">\r\n+                    <div className=\"rule-info\">\r\n+                      <span className=\"rule-key\">\r\n+                        {activeIssue.rule}\r\n+                      </span>\r\n+                      <span className=\"severity-label\">\r\n+                        {activeIssue.severity.toUpperCase()}\r\n+                      </span>\r\n+                    </div>\r\n+                  </div>\r\n \r\n-                  <button\r\n-                    className={activeTab === \"why\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"why\")}\r\n-                  >\r\n-                    Why is this an issue?\r\n-                  </button>\r\n-\r\n-                  <button\r\n-                    className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"fix\")}\r\n-                  >\r\n-                    How can I fix it?\r\n-                  </button>\r\n-\r\n-                  <button\r\n-                    className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"activity\")}\r\n-                  >\r\n-                    Activity\r\n-                  </button>\r\n-                </div>\r\n-\r\n-                <div className=\"issue-tab-content\">\r\n-\r\n-                  {activeTab === \"where\" && (\r\n-                    <div>\r\n-                      <p><strong>File:</strong> {activeIssue.file}</p>\r\n-                      <p><strong>Line:</strong> {activeIssue.line}</p>\r\n+                  <div className=\"sonar-body\">\r\n+                    <div className=\"icon-wrapper\">\r\n+                      <AlertCircle size={18} />\r\n                     </div>\r\n-                  )}\r\n \r\n-                  {activeTab === \"why\" && (\r\n-                    <div>\r\n-                      <h4>{activeIssue.rule}</h4>\r\n+                    <div className=\"description-wrapper\">\r\n                       <p>{activeIssue.description}</p>\r\n                     </div>\r\n-                  )}\r\n+                  </div>\r\n \r\n-                  {activeTab === \"fix\" && (\r\n-                    <div>\r\n-                      <p>\r\n-                        Refactor this code to avoid hardcoded values.\r\n-                        Move constants to configuration or environment variables.\r\n-                      </p>\r\n-                    </div>\r\n-                  )}\r\n-\r\n-                  {activeTab === \"activity\" && (\r\n-                    <div>\r\n-                      <p>No activity yet.</p>\r\n-                    </div>\r\n-                  )}\r\n-\r\n                 </div>\r\n-\r\n               </div>\r\n             )}\r\n \r\n           </React.Fragment>\r\n"
                },
                {
                    "date": 1772111849683,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -483,455 +483,4 @@\n   );\r\n };\r\n \r\n export default CodeViewer;\r\n-import React, { useState, useEffect, useRef } from \"react\";\r\n-import {\r\n-  Box,\r\n-  Typography,\r\n-  Breadcrumbs,\r\n-  Link\r\n-} from \"@mui/material\";\r\n-import {\r\n-  ChevronRight,\r\n-  ChevronDown,\r\n-  FileText,\r\n-  Copy,\r\n-  Maximize2,\r\n-  AlertCircle\r\n-} from \"lucide-react\";\r\n-import { toast } from \"react-toastify\";\r\n-\r\n-import { useLocation } from \"react-router-dom\";\r\n-import axios from \"axios\";\r\n-import \"./CodeViewer.css\";\r\n-\r\n-const CodeViewer = () => {\r\n-\r\n-  const location = useLocation();\r\n-  const projectKey = location.state?.projectKey;\r\n-  const initialIssue = location.state?.issue;\r\n-  const editorRef = useRef(null);\r\n-  const [openFiles, setOpenFiles] = useState({});\r\n-  const [autoFixOnly, setAutoFixOnly] = useState(false);\r\n-  const [issues, setIssues] = useState([]);\r\n-  const [fileContent, setFileContent] = useState(null);\r\n-  const [selectedFile, setSelectedFile] = useState(null);\r\n-  const [activeIssueId, setActiveIssueId] = useState(null);\r\n-  const [loading, setLoading] = useState(false);\r\n-\r\n-  /* ================= FETCH ISSUES ================= */\r\n-\r\n-  useEffect(() => {\r\n-    if (!projectKey) return;\r\n-    fetchIssues();\r\n-  }, [autoFixOnly, projectKey]);\r\n-\r\n-    useEffect(() => {\r\n-    if (!initialIssue || issues.length === 0) return;\r\n-\r\n-    const matchedIssue = issues.find(i => i.id === initialIssue.key);\r\n-    if (!matchedIssue) return;\r\n-\r\n-    openFile(matchedIssue.file);\r\n-    setActiveIssueId(matchedIssue.id);\r\n-\r\n-    setTimeout(() => {\r\n-      const el = document.getElementById(`line-${matchedIssue.line}`);\r\n-      if (el) {\r\n-        el.scrollIntoView({\r\n-          behavior: \"smooth\",\r\n-          block: \"center\"\r\n-        });\r\n-      }\r\n-    }, 400);\r\n-\r\n-  }, [issues, initialIssue]);\r\n-  \r\n-  const fetchIssues = async () => {\r\n-    try {\r\n-      setLoading(true);\r\n-\r\n-      const response = await axios.get(\r\n-        `http://localhost:8080/api/scan/${projectKey}/issues`,\r\n-        {\r\n-          params: {\r\n-            autoFixOnly,\r\n-            page: 1,\r\n-            pageSize: 200\r\n-          }\r\n-        }\r\n-      );\r\n-\r\n-      const backendIssues =\r\n-        response.data.content?.flatMap(group => group.issues) || [];\r\n-\r\n-const mapped = backendIssues.map(issue => ({\r\n-  id: issue.key,\r\n-  file: issue.filePath,\r\n-  title: issue.message,        // ✅ show actual message\r\n-  rule: issue.rule,            // keep rule separately\r\n-  description: issue.description,\r\n-  severity: issue.severity?.toLowerCase() || \"minor\",\r\n-  line: issue.line,\r\n-  autoFix: issue.autoFixable,\r\n-  selected: false\r\n-}));\r\n-      setIssues(mapped);\r\n-\r\n-      const fileMap = {};\r\n-      mapped.forEach(i => fileMap[i.file] = true);\r\n-      setOpenFiles(fileMap);\r\n-\r\n-    } catch (err) {\r\n-      console.error(\"Error fetching issues:\", err);\r\n-    } finally {\r\n-      setLoading(false);\r\n-    }\r\n-  };\r\n-\r\n-  const toggleIssue = (id) => {\r\n-  setIssues(prev =>\r\n-    prev.map(issue =>\r\n-      issue.id === id\r\n-        ? { ...issue, selected: !issue.selected }\r\n-        : issue\r\n-    )\r\n-  );\r\n-};\r\n-\r\n-  /* ================= FETCH FILE ================= */\r\n-\r\n-  const openFile = async (filePath) => {\r\n-    try {\r\n-      const response = await axios.get(\r\n-        `http://localhost:8080/api/files/${projectKey}`,\r\n-        { params: { filePath } }\r\n-      );\r\n-\r\n-      setFileContent(response.data);\r\n-      setSelectedFile(filePath);\r\n-\r\n-    } catch (err) {\r\n-      console.error(\"Failed to load file\", err);\r\n-    }\r\n-  };\r\n-\r\n-  /* ================= GROUP FILES ================= */\r\n-\r\n-  const files = [...new Set(issues.map(i => i.file))];\r\n-\r\n-  const getFileIssues = (filePath) =>\r\n-    issues.filter(issue => issue.file === filePath);\r\n-\r\n-  const isFileFullySelected = (filePath) => {\r\n-    const fileIssues = getFileIssues(filePath);\r\n-    if (fileIssues.length === 0) return false;\r\n-    return fileIssues.every(i => i.selected);\r\n-  };\r\n-\r\n-  const toggleFileSelectAll = (filePath) => {\r\n-    const fileIssues = getFileIssues(filePath);\r\n-    const allSelected = fileIssues.every(i => i.selected);\r\n-\r\n-    setIssues(prev =>\r\n-      prev.map(issue =>\r\n-        issue.file === filePath\r\n-          ? { ...issue, selected: !allSelected }\r\n-          : issue\r\n-      )\r\n-    );\r\n-  };\r\n-\r\n-  const toggleFileExpand = (filePath) => {\r\n-    setOpenFiles(prev => ({\r\n-      ...prev,\r\n-      [filePath]: !prev[filePath]\r\n-    }));\r\n-  };\r\n-\r\n-  /* ================= AUTO FIX ================= */\r\n-\r\n-  const applySelected = async () => {\r\n-    const selectedIssues = issues.filter(i => i.selected);\r\n-    if (selectedIssues.length === 0) return toast.error(\"No issues selected\");\r\n-\r\n-    try {\r\n-      await axios.post(\"http://localhost:8080/api/fix/apply\", {\r\n-        issueKeys: selectedIssues.map(i => i.id),\r\n-        projectKey\r\n-      });\r\n-      fetchIssues();\r\n-    } catch (err) {\r\n-      console.error(\"Auto-fix failed\", err);\r\n-    }\r\n-  };\r\n-\r\n-  const applyAll = async () => {\r\n-    if (issues.length === 0) return toast.error(\"No issues to apply\");\r\n-\r\n-    try {\r\n-      await axios.post(\"http://localhost:8080/api/fix/apply\", {\r\n-        issueKeys: issues.map(i => i.id),\r\n-        projectKey\r\n-      });\r\n-      fetchIssues();\r\n-    } catch (err) {\r\n-      console.error(\"Auto-fix all failed\", err);\r\n-    }\r\n-  };\r\n-const maskFilePath = (fullPath) => {\r\n-  if (!fullPath) return \"\";\r\n-\r\n-  const parts = fullPath.split(\"/\");\r\n-\r\n-  if (parts.length <= 3) return fullPath; \r\n-\r\n-  const first = parts[0]; \r\n-  const lastFolder = parts[parts.length - 2];\r\n-  const fileName = parts[parts.length - 1];\r\n-\r\n-  return `${first}/../${lastFolder}/${fileName}`;\r\n-};\r\n-\r\n-  const handleCopy = async () => {\r\n-  if (!fileContent?.lines) return;\r\n-\r\n-  const fullText = fileContent.lines\r\n-    .map(line =>\r\n-      line.segments.map(segment => segment.text).join(\"\")\r\n-    )\r\n-    .join(\"\\n\");\r\n-\r\n-  try {\r\n-    await navigator.clipboard.writeText(fullText);\r\n-    toast.success(\"Copied to clipboard\");\r\n-  } catch (err) {\r\n-    toast.error(\"Copy failed\", err);\r\n-  }\r\n-};\r\n-\r\n-const handleFullScreen = () => {\r\n-  if (!editorRef.current) return;\r\n-\r\n-  if (!document.fullscreenElement) {\r\n-    editorRef.current.requestFullscreen();\r\n-  } else {\r\n-    document.exitFullscreen();\r\n-  }\r\n-};\r\n-\r\n-  return (\r\n-    <Box className=\"code-viewer-page\">\r\n-\r\n-      <Box className=\"code-viewer-nav\">\r\n-        <Breadcrumbs separator={<ChevronRight size={14} color=\"#94a3b8\" />}>\r\n-          <Link underline=\"hover\" color=\"#64748b\">Projects</Link>\r\n-          <Link underline=\"hover\" color=\"#64748b\">{projectKey}</Link>\r\n-          <Typography sx={{ fontSize: \"13px\", fontWeight: 600 }}>\r\n-            Code Viewer\r\n-          </Typography>\r\n-        </Breadcrumbs>\r\n-      </Box>\r\n-\r\n-      <main className=\"layout\">\r\n-\r\n-        {/* LEFT PANEL */}\r\n-        <aside className=\"left-panel\">\r\n-\r\n-          <div className=\"left-header\">\r\n-            <div className=\"left-title\">\r\n-              <h3>TOTAL ISSUES</h3>\r\n-              <span className=\"badge\">{issues.length} TOTAL</span>\r\n-            </div>\r\n-\r\n-            <div className=\"controls\">\r\n-              <div className=\"toggle-box\">\r\n-                <span>Auto-Fixable Only</span>\r\n-                <div\r\n-                  className={`toggle ${autoFixOnly ? \"active\" : \"\"}`}\r\n-                  onClick={() => setAutoFixOnly(prev => !prev)}\r\n-                >\r\n-                  <div className=\"toggle-dot\"></div>\r\n-                </div>\r\n-              </div>\r\n-\r\n-              <div className=\"btn-row\">\r\n-                <button className=\"btn-outline\" onClick={applySelected}>\r\n-                  Auto-Fix Selected\r\n-                </button>\r\n-                <button className=\"btn-primary\" onClick={applyAll}>\r\n-                  Auto-Fix All\r\n-                </button>\r\n-              </div>\r\n-            </div>\r\n-          </div>\r\n-\r\n-          <div className=\"issue-list\">\r\n-            {files.map(filePath => (\r\n-              <div className=\"file-group\" key={filePath}>\r\n-\r\n-                <div\r\n-                  className={`file-header ${selectedFile === filePath ? \"selected-file\" : \"\"}`}\r\n-                  onClick={() => {\r\n-                    if (selectedFile !== filePath) {\r\n-                      openFile(filePath);\r\n-                    }\r\n-                  }}\r\n-                >\r\n-                  <input\r\n-                    type=\"checkbox\"\r\n-                    checked={isFileFullySelected(filePath)}\r\n-                    onClick={(e) => e.stopPropagation()}\r\n-                    onChange={() => toggleFileSelectAll(filePath)}\r\n-                  />\r\n-\r\n-                  <span\r\n-                    onClick={(e) => {\r\n-                      e.stopPropagation();\r\n-                      toggleFileExpand(filePath);\r\n-                    }}\r\n-                  >\r\n-                    {openFiles[filePath] ? (\r\n-                      <ChevronDown size={16} />\r\n-                    ) : (\r\n-                      <ChevronRight size={16} />\r\n-                    )}\r\n-                  </span>\r\n-\r\n-                  <FileText size={18} />\r\n-                 <span className=\"file-name\">{maskFilePath(filePath)}</span>\r\n-                </div>\r\n-\r\n-            {openFiles[filePath] &&\r\n-  getFileIssues(filePath).map(issue => (\r\n-    <div\r\n-      key={issue.id}\r\n-      className={`issue-item ${issue.selected ? \"active\" : \"\"}`}\r\n-      onClick={() => {\r\n-        openFile(issue.file);\r\n-\r\n-        setActiveIssueId(prev =>\r\n-          prev === issue.id ? null : issue.id\r\n-        );\r\n-\r\n-        setTimeout(() => {\r\n-          const el = document.getElementById(`line-${issue.line}`);\r\n-          if (el) {\r\n-            el.scrollIntoView({\r\n-              behavior: \"smooth\",\r\n-              block: \"center\"\r\n-            });\r\n-          }\r\n-        }, 300);\r\n-      }}\r\n-    >\r\n-\r\n-      \r\n-    <input type=\"checkbox\" checked={issue.selected}\r\n-      onChange={(e) => {\r\n-      e.stopPropagation();\r\n-      toggleIssue(issue.id);\r\n-    }}\r\n-    onClick={(e) => e.stopPropagation()}/>\r\n-      <div className=\"issue-content\">\r\n-        <div className=\"issue-top\">\r\n-          <h4>{issue.message}</h4>\r\n-          {issue.autoFix && <span className=\"auto\">AUTO</span>}\r\n-        </div>\r\n-\r\n-        <p>{issue.title}</p>\r\n-\r\n-        <div className=\"issue-meta\">\r\n-          <span className={issue.severity}>\r\n-            {issue.severity.toUpperCase()}\r\n-          </span>\r\n-          <span className=\"line\">Line {issue.line}</span>\r\n-        </div>\r\n-      </div>\r\n-\r\n-    </div>\r\n-))}\r\n-              </div>\r\n-            ))}\r\n-          </div>\r\n-        </aside>\r\n-\r\n-        {/* CENTER PANEL */}\r\n-        <section className=\"center-panel\" ref={editorRef}>\r\n-\r\n-          <div className=\"editor-header\">\r\n-            <div className=\"editor-title\">\r\n-              {selectedFile || \"Select a file\"}\r\n-            </div>\r\n-            <div className=\"editor-actions\">\r\n-              <button onClick={handleCopy} className=\"icon-btn\">\r\n-              <Copy size={18} />\r\n-            </button>\r\n-\r\n-            <button onClick={handleFullScreen} className=\"icon-btn\">\r\n-              <Maximize2 size={18} />\r\n-            </button>\r\n-           </div>\r\n-          </div>\r\n-\r\n- <div className=\"editor-body\">\r\n-  <div className=\"code-area\">\r\n-    {fileContent?.lines?.map(line => {\r\n-\r\n-      const activeIssue = issues.find(\r\n-        issue =>\r\n-          issue.line === line.lineNumber &&\r\n-          issue.id === activeIssueId\r\n-      );\r\n-\r\n-      const hasActiveIssue = !!activeIssue;\r\n-\r\n-      return (\r\n-        <React.Fragment key={line.lineNumber}>\r\n-          <div\r\n-            id={`line-${line.lineNumber}`}\r\n-            className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n-          >\r\n-            <span>{line.lineNumber}</span>\r\n-\r\n-            {line.segments.map((segment, idx) => (\r\n-              <span\r\n-                key={idx}\r\n-                className={segment.highlighted ? \"highlight\" : \"\"}\r\n-              >\r\n-                {segment.text}\r\n-              </span>\r\n-            ))}\r\n-          </div>\r\n-\r\n-          {hasActiveIssue && (\r\n-            <div className=\"issue-popup-row\">\r\n-              <div className=\"popup\">\r\n-                <div className=\"popup-icon\">\r\n-                  <AlertCircle size={16} />\r\n-                </div>\r\n-                <div>\r\n-                  <h4>{activeIssue.rule}</h4>\r\n-                  <p className=\"popup-sub\">\r\n-                    {activeIssue.severity.toUpperCase()}\r\n-                  </p>\r\n-                  <p className=\"popup-text\">\r\n-                    {activeIssue.description}\r\n-                  </p>\r\n-                </div>\r\n-              </div>\r\n-            </div>\r\n-          )}\r\n-        </React.Fragment>\r\n-      );\r\n-    })}\r\n-  </div>\r\n-</div>\r\n-        </section>\r\n-\r\n-      </main>\r\n-    </Box>\r\n-  );\r\n-};\r\n-\r\n-export default CodeViewer;\r\n"
                },
                {
                    "date": 1772111984089,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -462,9 +462,9 @@\n                       <AlertCircle size={18} />\r\n                     </div>\r\n \r\n                     <div className=\"description-wrapper\">\r\n-                      <p>{activeIssue.description}</p>\r\n+                      <p>{activeIssue.descriptin}</p>\r\n                     </div>\r\n                   </div>\r\n \r\n                 </div>\r\n"
                },
                {
                    "date": 1772111994961,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -462,9 +462,9 @@\n                       <AlertCircle size={18} />\r\n                     </div>\r\n \r\n                     <div className=\"description-wrapper\">\r\n-                      <p>{activeIssue.descriptin}</p>\r\n+                      <p>{activeIssue.title}</p>\r\n                     </div>\r\n                   </div>\r\n \r\n                 </div>\r\n"
                },
                {
                    "date": 1772112212565,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -462,9 +462,9 @@\n                       <AlertCircle size={18} />\r\n                     </div>\r\n \r\n                     <div className=\"description-wrapper\">\r\n-                      <p>{activeIssue.title}</p>\r\n+                      <p>{activeIssue.ti}</p>\r\n                     </div>\r\n                   </div>\r\n \r\n                 </div>\r\n"
                },
                {
                    "date": 1772112259318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -405,9 +405,9 @@\n           </div>\r\n         </aside>\r\n \r\n         {/* CENTER PANEL */}\r\n-<section className=\"center-panel\" ref={editorRef}>\r\n+       <section className=\"center-panel\" ref={editorRef}>\r\n   <div className=\"editor-body\">\r\n     <div className=\"code-area\">\r\n       {fileContent?.lines?.map(line => {\r\n \r\n@@ -420,10 +420,9 @@\n         const hasActiveIssue = !!activeIssue;\r\n \r\n         return (\r\n           <React.Fragment key={line.lineNumber}>\r\n-\r\n-            {/* CODE LINE */}\r\n+            \r\n             <div\r\n               id={`line-${line.lineNumber}`}\r\n               className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n             >\r\n@@ -431,44 +430,107 @@\n                 {line.lineNumber}\r\n               </span>\r\n \r\n               {line.segments.map((segment, idx) => (\r\n-                <span\r\n-                  key={idx}\r\n-                  className={segment.highlighted ? \"highlight\" : \"\"}\r\n-                >\r\n+                <span key={idx}>\r\n                   {segment.text}\r\n                 </span>\r\n               ))}\r\n             </div>\r\n \r\n-            {/* SONAR STYLE POPUP */}\r\n             {hasActiveIssue && (\r\n-              <div className=\"issue-popup-row\">\r\n-                <div className=\"sonar-card\">\r\n+              <div className=\"issue-inline-panel\">\r\n \r\n-                  <div className=\"sonar-header\">\r\n-                    <div className=\"rule-info\">\r\n-                      <span className=\"rule-key\">\r\n-                        {activeIssue.rule}\r\n-                      </span>\r\n-                      <span className=\"severity-label\">\r\n-                        {activeIssue.severity.toUpperCase()}\r\n-                      </span>\r\n+                <div className=\"issue-tabs\">\r\n+                  <button\r\n+                    className={activeTab === \"where\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"where\")}\r\n+                  >\r\n+                    Where is the issue?\r\n+                  </button>\r\n+\r\n+                  <button\r\n+                    className={activeTab === \"why\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"why\")}\r\n+                  >\r\n+                    Why is this an issue?\r\n+                  </button>\r\n+\r\n+                  <button\r\n+                    className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"fix\")}\r\n+                  >\r\n+                    How can I fix it?\r\n+                  </button>\r\n+\r\n+                  <button\r\n+                    className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n+                    onClick={() => setActiveTab(\"activity\")}\r\n+                  >\r\n+                    Activity\r\n+                  </button>\r\n+                </div>\r\n+\r\n+                <div className=\"issue-tab-content\">\r\n+\r\n+{activeTab === \"where\" && (\r\n+  <div className=\"issue-popup-row\">\r\n+    <div className=\"sonar-card\">\r\n+\r\n+      <div className=\"sonar-header\">\r\n+        <div className=\"rule-info\">\r\n+          <span className=\"rule-key\">\r\n+            {activeIssue.rule}\r\n+          </span>\r\n+          <span className=\"severity-label\">\r\n+            {activeIssue.severity.toUpperCase()}\r\n+          </span>\r\n+        </div>\r\n+      </div>\r\n+\r\n+      <div className=\"sonar-body\">\r\n+        <div className=\"icon-wrapper\">\r\n+          <AlertCircle size={18} />\r\n+        </div>\r\n+\r\n+        <div className=\"description-wrapper\">\r\n+          <p>{activeIssue.title}</p>\r\n+        </div>\r\n+      </div>\r\n+\r\n+      <div className=\"where-meta\">\r\n+        <p><strong>File:</strong> {activeIssue.file}</p>\r\n+        <p><strong>Line:</strong> {activeIssue.line}</p>\r\n+      </div>\r\n+\r\n+    </div>\r\n+  </div>\r\n+)}\r\n+\r\n+                  {activeTab === \"why\" && (\r\n+                    <div>\r\n+                      <h4>{activeIssue.rule}</h4>\r\n+                      <p>{activeIssue.description}</p>\r\n                     </div>\r\n-                  </div>\r\n+                  )}\r\n \r\n-                  <div className=\"sonar-body\">\r\n-                    <div className=\"icon-wrapper\">\r\n-                      <AlertCircle size={18} />\r\n+                  {activeTab === \"fix\" && (\r\n+                    <div>\r\n+                      <p>\r\n+                        Refactor this code to avoid hardcoded values.\r\n+                        Move constants to configuration or environment variables.\r\n+                      </p>\r\n                     </div>\r\n+                  )}\r\n \r\n-                    <div className=\"description-wrapper\">\r\n-                      <p>{activeIssue.ti}</p>\r\n+                  {activeTab === \"activity\" && (\r\n+                    <div>\r\n+                      <p>No activity yet.</p>\r\n                     </div>\r\n-                  </div>\r\n+                  )}\r\n \r\n                 </div>\r\n+\r\n               </div>\r\n             )}\r\n \r\n           </React.Fragment>\r\n"
                },
                {
                    "date": 1772112683957,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -471,42 +471,15 @@\n                 </div>\r\n \r\n                 <div className=\"issue-tab-content\">\r\n \r\n-{activeTab === \"where\" && (\r\n-  <div className=\"issue-popup-row\">\r\n-    <div className=\"sonar-card\">\r\n+                  {activeTab === \"where\" && (\r\n+                    <div>\r\n+                      <p><strong>File:</strong> {activeIssue.file}</p>\r\n+                      <p><strong>Line:</strong> {activeIssue.line}</p>\r\n+                    </div>\r\n+                  )}\r\n \r\n-      <div className=\"sonar-header\">\r\n-        <div className=\"rule-info\">\r\n-          <span className=\"rule-key\">\r\n-            {activeIssue.rule}\r\n-          </span>\r\n-          <span className=\"severity-label\">\r\n-            {activeIssue.severity.toUpperCase()}\r\n-          </span>\r\n-        </div>\r\n-      </div>\r\n-\r\n-      <div className=\"sonar-body\">\r\n-        <div className=\"icon-wrapper\">\r\n-          <AlertCircle size={18} />\r\n-        </div>\r\n-\r\n-        <div className=\"description-wrapper\">\r\n-          <p>{activeIssue.title}</p>\r\n-        </div>\r\n-      </div>\r\n-\r\n-      <div className=\"where-meta\">\r\n-        <p><strong>File:</strong> {activeIssue.file}</p>\r\n-        <p><strong>Line:</strong> {activeIssue.line}</p>\r\n-      </div>\r\n-\r\n-    </div>\r\n-  </div>\r\n-)}\r\n-\r\n                   {activeTab === \"why\" && (\r\n                     <div>\r\n                       <h4>{activeIssue.rule}</h4>\r\n                       <p>{activeIssue.description}</p>\r\n"
                },
                {
                    "date": 1772112692451,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -406,8 +406,42 @@\n         </aside>\r\n \r\n         {/* CENTER PANEL */}\r\n        <section className=\"center-panel\" ref={editorRef}>\r\n+\r\n+  {/* Tabs (Render ONCE) */}\r\n+  {activeIssueId && (\r\n+    <div className=\"issue-tabs\">\r\n+      <button\r\n+        className={activeTab === \"where\" ? \"active\" : \"\"}\r\n+        onClick={() => setActiveTab(\"where\")}\r\n+      >\r\n+        Where is the issue?\r\n+      </button>\r\n+\r\n+      <button\r\n+        className={activeTab === \"why\" ? \"active\" : \"\"}\r\n+        onClick={() => setActiveTab(\"why\")}\r\n+      >\r\n+        Why is this an issue?\r\n+      </button>\r\n+\r\n+      <button\r\n+        className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n+        onClick={() => setActiveTab(\"fix\")}\r\n+      >\r\n+        How can I fix it?\r\n+      </button>\r\n+\r\n+      <button\r\n+        className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n+        onClick={() => setActiveTab(\"activity\")}\r\n+      >\r\n+        Activity\r\n+      </button>\r\n+    </div>\r\n+  )}\r\n+\r\n   <div className=\"editor-body\">\r\n     <div className=\"code-area\">\r\n       {fileContent?.lines?.map(line => {\r\n \r\n@@ -420,9 +454,9 @@\n         const hasActiveIssue = !!activeIssue;\r\n \r\n         return (\r\n           <React.Fragment key={line.lineNumber}>\r\n-            \r\n+\r\n             <div\r\n               id={`line-${line.lineNumber}`}\r\n               className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n             >\r\n@@ -436,74 +470,47 @@\n                 </span>\r\n               ))}\r\n             </div>\r\n \r\n-            {hasActiveIssue && (\r\n-              <div className=\"issue-inline-panel\">\r\n-\r\n-                <div className=\"issue-tabs\">\r\n-                  <button\r\n-                    className={activeTab === \"where\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"where\")}\r\n-                  >\r\n-                    Where is the issue?\r\n-                  </button>\r\n-\r\n-                  <button\r\n-                    className={activeTab === \"why\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"why\")}\r\n-                  >\r\n-                    Why is this an issue?\r\n-                  </button>\r\n-\r\n-                  <button\r\n-                    className={activeTab === \"fix\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"fix\")}\r\n-                  >\r\n-                    How can I fix it?\r\n-                  </button>\r\n-\r\n-                  <button\r\n-                    className={activeTab === \"activity\" ? \"active\" : \"\"}\r\n-                    onClick={() => setActiveTab(\"activity\")}\r\n-                  >\r\n-                    Activity\r\n-                  </button>\r\n-                </div>\r\n-\r\n-                <div className=\"issue-tab-content\">\r\n-\r\n-                  {activeTab === \"where\" && (\r\n-                    <div>\r\n-                      <p><strong>File:</strong> {activeIssue.file}</p>\r\n-                      <p><strong>Line:</strong> {activeIssue.line}</p>\r\n+            {/* Only the content changes */}\r\n+            {hasActiveIssue && activeTab === \"where\" && (\r\n+              <div className=\"issue-popup-row\">\r\n+                <div className=\"sonar-card\">\r\n+                  <div className=\"sonar-header\">\r\n+                    <div className=\"rule-info\">\r\n+                      <span className=\"rule-key\">\r\n+                        {activeIssue.rule}\r\n+                      </span>\r\n+                      <span className=\"severity-label\">\r\n+                        {activeIssue.severity.toUpperCase()}\r\n+                      </span>\r\n                     </div>\r\n-                  )}\r\n+                  </div>\r\n \r\n-                  {activeTab === \"why\" && (\r\n-                    <div>\r\n-                      <h4>{activeIssue.rule}</h4>\r\n-                      <p>{activeIssue.description}</p>\r\n+                  <div className=\"sonar-body\">\r\n+                    <div className=\"icon-wrapper\">\r\n+                      <AlertCircle size={18} />\r\n                     </div>\r\n-                  )}\r\n \r\n-                  {activeTab === \"fix\" && (\r\n-                    <div>\r\n-                      <p>\r\n-                        Refactor this code to avoid hardcoded values.\r\n-                        Move constants to configuration or environment variables.\r\n-                      </p>\r\n+                    <div className=\"description-wrapper\">\r\n+                      <p>{activeIssue.title}</p>\r\n                     </div>\r\n-                  )}\r\n+                  </div>\r\n \r\n-                  {activeTab === \"activity\" && (\r\n-                    <div>\r\n-                      <p>No activity yet.</p>\r\n-                    </div>\r\n-                  )}\r\n+                  <div className=\"where-meta\">\r\n+                    <p><strong>File:</strong> {activeIssue.file}</p>\r\n+                    <p><strong>Line:</strong> {activeIssue.line}</p>\r\n+                  </div>\r\n+                </div>\r\n+              </div>\r\n+            )}\r\n \r\n+            {hasActiveIssue && activeTab === \"why\" && (\r\n+              <div className=\"issue-popup-row\">\r\n+                <div className=\"sonar-card\">\r\n+                  <h4>{activeIssue.rule}</h4>\r\n+                  <p>{activeIssue.description}</p>\r\n                 </div>\r\n-\r\n               </div>\r\n             )}\r\n \r\n           </React.Fragment>\r\n"
                },
                {
                    "date": 1772112941065,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -495,12 +495,9 @@\n                       <p>{activeIssue.title}</p>\r\n                     </div>\r\n                   </div>\r\n \r\n-                  <div className=\"where-meta\">\r\n-                    <p><strong>File:</strong> {activeIssue.file}</p>\r\n-                    <p><strong>Line:</strong> {activeIssue.line}</p>\r\n-                  </div>\r\n+                 \r\n                 </div>\r\n               </div>\r\n             )}\r\n \r\n"
                },
                {
                    "date": 1772113078580,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -405,11 +405,11 @@\n           </div>\r\n         </aside>\r\n \r\n         {/* CENTER PANEL */}\r\n-       <section className=\"center-panel\" ref={editorRef}>\r\n+     <section className=\"center-panel\" ref={editorRef}>\r\n \r\n-  {/* Tabs (Render ONCE) */}\r\n+  {/* Tabs */}\r\n   {activeIssueId && (\r\n     <div className=\"issue-tabs\">\r\n       <button\r\n         className={activeTab === \"where\" ? \"active\" : \"\"}\r\n@@ -440,8 +440,23 @@\n       </button>\r\n     </div>\r\n   )}\r\n \r\n+  {/* Editor Header — OUTSIDE LOOP */}\r\n+  <div className=\"editor-header\">\r\n+    <div className=\"editor-title\">\r\n+      {selectedFile || \"Select a file\"}\r\n+    </div>\r\n+    <div className=\"editor-actions\">\r\n+      <button onClick={handleCopy} className=\"icon-btn\">\r\n+        <Copy size={18} />\r\n+      </button>\r\n+      <button onClick={handleFullScreen} className=\"icon-btn\">\r\n+        <Maximize2 size={18} />\r\n+      </button>\r\n+    </div>\r\n+  </div>\r\n+\r\n   <div className=\"editor-body\">\r\n     <div className=\"code-area\">\r\n       {fileContent?.lines?.map(line => {\r\n \r\n@@ -470,11 +485,10 @@\n                 </span>\r\n               ))}\r\n             </div>\r\n \r\n-            {/* Only the content changes */}\r\n+            {/* Inline Issue Card */}\r\n             {hasActiveIssue && activeTab === \"where\" && (\r\n-              <div className=\"editor-header\"> <div className=\"editor-title\"> {selectedFile || \"Select a file\"} </div> <div className=\"editor-actions\"> <button onClick={handleCopy} className=\"icon-btn\"> <Copy size={18} /> </button> <button onClick={handleFullScreen} className=\"icon-btn\"> <Maximize2 size={18} /> </button> </div> </div>\r\n               <div className=\"issue-popup-row\">\r\n                 <div className=\"sonar-card\">\r\n                   <div className=\"sonar-header\">\r\n                     <div className=\"rule-info\">\r\n@@ -495,10 +509,8 @@\n                     <div className=\"description-wrapper\">\r\n                       <p>{activeIssue.title}</p>\r\n                     </div>\r\n                   </div>\r\n-\r\n-                 \r\n                 </div>\r\n               </div>\r\n             )}\r\n \r\n@@ -516,9 +528,8 @@\n       })}\r\n     </div>\r\n   </div>\r\n </section>\r\n-\r\n       </main>\r\n     </Box>\r\n   );\r\n };\r\n"
                },
                {
                    "date": 1772113240705,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -405,11 +405,10 @@\n           </div>\r\n         </aside>\r\n \r\n         {/* CENTER PANEL */}\r\n-     <section className=\"center-panel\" ref={editorRef}>\r\n+ <section className=\"center-panel\" ref={editorRef}>\r\n \r\n-  {/* Tabs */}\r\n   {activeIssueId && (\r\n     <div className=\"issue-tabs\">\r\n       <button\r\n         className={activeTab === \"where\" ? \"active\" : \"\"}\r\n@@ -440,95 +439,100 @@\n       </button>\r\n     </div>\r\n   )}\r\n \r\n-  {/* Editor Header — OUTSIDE LOOP */}\r\n-  <div className=\"editor-header\">\r\n-    <div className=\"editor-title\">\r\n-      {selectedFile || \"Select a file\"}\r\n-    </div>\r\n-    <div className=\"editor-actions\">\r\n-      <button onClick={handleCopy} className=\"icon-btn\">\r\n-        <Copy size={18} />\r\n-      </button>\r\n-      <button onClick={handleFullScreen} className=\"icon-btn\">\r\n-        <Maximize2 size={18} />\r\n-      </button>\r\n-    </div>\r\n-  </div>\r\n+  {/* WHERE TAB → SHOW CODE */}\r\n+  {activeTab === \"where\" && (\r\n+    <>\r\n+      <div className=\"editor-header\">\r\n+        <div className=\"editor-title\">\r\n+          {selectedFile || \"Select a file\"}\r\n+        </div>\r\n+        <div className=\"editor-actions\">\r\n+          <button onClick={handleCopy} className=\"icon-btn\">\r\n+            <Copy size={18} />\r\n+          </button>\r\n+          <button onClick={handleFullScreen} className=\"icon-btn\">\r\n+            <Maximize2 size={18} />\r\n+          </button>\r\n+        </div>\r\n+      </div>\r\n \r\n-  <div className=\"editor-body\">\r\n-    <div className=\"code-area\">\r\n-      {fileContent?.lines?.map(line => {\r\n+      <div className=\"editor-body\">\r\n+        <div className=\"code-area\">\r\n+          {fileContent?.lines?.map(line => {\r\n \r\n-        const activeIssue = issues.find(\r\n-          issue =>\r\n-            issue.line === line.lineNumber &&\r\n-            issue.id === activeIssueId\r\n-        );\r\n+            const activeIssue = issues.find(\r\n+              issue =>\r\n+                issue.line === line.lineNumber &&\r\n+                issue.id === activeIssueId\r\n+            );\r\n \r\n-        const hasActiveIssue = !!activeIssue;\r\n+            const hasActiveIssue = !!activeIssue;\r\n \r\n-        return (\r\n-          <React.Fragment key={line.lineNumber}>\r\n+            return (\r\n+              <React.Fragment key={line.lineNumber}>\r\n \r\n-            <div\r\n-              id={`line-${line.lineNumber}`}\r\n-              className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n-            >\r\n-              <span className=\"line-number\">\r\n-                {line.lineNumber}\r\n-              </span>\r\n+                <div\r\n+                  id={`line-${line.lineNumber}`}\r\n+                  className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n+                >\r\n+                  <span className=\"line-number\">\r\n+                    {line.lineNumber}\r\n+                  </span>\r\n \r\n-              {line.segments.map((segment, idx) => (\r\n-                <span key={idx}>\r\n-                  {segment.text}\r\n-                </span>\r\n-              ))}\r\n-            </div>\r\n+                  {line.segments.map((segment, idx) => (\r\n+                    <span key={idx}>\r\n+                      {segment.text}\r\n+                    </span>\r\n+                  ))}\r\n+                </div>\r\n \r\n-            {/* Inline Issue Card */}\r\n-            {hasActiveIssue && activeTab === \"where\" && (\r\n-              <div className=\"issue-popup-row\">\r\n-                <div className=\"sonar-card\">\r\n-                  <div className=\"sonar-header\">\r\n-                    <div className=\"rule-info\">\r\n-                      <span className=\"rule-key\">\r\n-                        {activeIssue.rule}\r\n-                      </span>\r\n-                      <span className=\"severity-label\">\r\n-                        {activeIssue.severity.toUpperCase()}\r\n-                      </span>\r\n-                    </div>\r\n-                  </div>\r\n+                {hasActiveIssue && (\r\n+                  <div className=\"issue-popup-row\">\r\n+                    <div className=\"sonar-card\">\r\n+                      <div className=\"sonar-header\">\r\n+                        <div className=\"rule-info\">\r\n+                          <span className=\"rule-key\">\r\n+                            {activeIssue.rule}\r\n+                          </span>\r\n+                          <span className=\"severity-label\">\r\n+                            {activeIssue.severity.toUpperCase()}\r\n+                          </span>\r\n+                        </div>\r\n+                      </div>\r\n \r\n-                  <div className=\"sonar-body\">\r\n-                    <div className=\"icon-wrapper\">\r\n-                      <AlertCircle size={18} />\r\n-                    </div>\r\n+                      <div className=\"sonar-body\">\r\n+                        <div className=\"icon-wrapper\">\r\n+                          <AlertCircle size={18} />\r\n+                        </div>\r\n \r\n-                    <div className=\"description-wrapper\">\r\n-                      <p>{activeIssue.title}</p>\r\n+                        <div className=\"description-wrapper\">\r\n+                          <p>{activeIssue.title}</p>\r\n+                        </div>\r\n+                      </div>\r\n                     </div>\r\n                   </div>\r\n-                </div>\r\n-              </div>\r\n-            )}\r\n+                )}\r\n \r\n-            {hasActiveIssue && activeTab === \"why\" && (\r\n-              <div className=\"issue-popup-row\">\r\n-                <div className=\"sonar-card\">\r\n-                  <h4>{activeIssue.rule}</h4>\r\n-                  <p>{activeIssue.description}</p>\r\n-                </div>\r\n-              </div>\r\n-            )}\r\n+              </React.Fragment>\r\n+            );\r\n+          })}\r\n+        </div>\r\n+      </div>\r\n+    </>\r\n+  )}\r\n \r\n-          </React.Fragment>\r\n-        );\r\n-      })}\r\n+  {/* WHY TAB → SHOW ONLY DESCRIPTION */}\r\n+  {activeTab === \"why\" && (\r\n+    <div className=\"issue-popup-row\">\r\n+      <div className=\"sonar-card\">\r\n+        <h4>{issues.find(i => i.id === activeIssueId)?.rule}</h4>\r\n+        <p>{issues.find(i => i.id === activeIssueId)?.description}</p>\r\n+      </div>\r\n     </div>\r\n-  </div>\r\n+  )}\r\n+\r\n </section>\r\n       </main>\r\n     </Box>\r\n   );\r\n"
                }
            ],
            "date": 1772110404470,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect, useRef } from \"react\";\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Breadcrumbs,\r\n  Link\r\n} from \"@mui/material\";\r\nimport {\r\n  ChevronRight,\r\n  ChevronDown,\r\n  FileText,\r\n  Copy,\r\n  Maximize2,\r\n  AlertCircle\r\n} from \"lucide-react\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nimport { useLocation } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport \"./CodeViewer.css\";\r\n\r\nconst CodeViewer = () => {\r\n\r\n  const location = useLocation();\r\n  const projectKey = location.state?.projectKey;\r\n  const initialIssue = location.state?.issue;\r\n  const editorRef = useRef(null);\r\n  const [openFiles, setOpenFiles] = useState({});\r\n  const [autoFixOnly, setAutoFixOnly] = useState(false);\r\n  const [issues, setIssues] = useState([]);\r\n  const [fileContent, setFileContent] = useState(null);\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [activeIssueId, setActiveIssueId] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  /* ================= FETCH ISSUES ================= */\r\n\r\n  useEffect(() => {\r\n    if (!projectKey) return;\r\n    fetchIssues();\r\n  }, [autoFixOnly, projectKey]);\r\n\r\n    useEffect(() => {\r\n    if (!initialIssue || issues.length === 0) return;\r\n\r\n    const matchedIssue = issues.find(i => i.id === initialIssue.key);\r\n    if (!matchedIssue) return;\r\n\r\n    openFile(matchedIssue.file);\r\n    setActiveIssueId(matchedIssue.id);\r\n\r\n    setTimeout(() => {\r\n      const el = document.getElementById(`line-${matchedIssue.line}`);\r\n      if (el) {\r\n        el.scrollIntoView({\r\n          behavior: \"smooth\",\r\n          block: \"center\"\r\n        });\r\n      }\r\n    }, 400);\r\n\r\n  }, [issues, initialIssue]);\r\n  \r\n  const fetchIssues = async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const response = await axios.get(\r\n        `http://localhost:8080/api/scan/${projectKey}/issues`,\r\n        {\r\n          params: {\r\n            autoFixOnly,\r\n            page: 1,\r\n            pageSize: 200\r\n          }\r\n        }\r\n      );\r\n\r\n      const backendIssues =\r\n        response.data.content?.flatMap(group => group.issues) || [];\r\n\r\nconst mapped = backendIssues.map(issue => ({\r\n  id: issue.key,\r\n  file: issue.filePath,\r\n  title: issue.message,        // ✅ show actual message\r\n  rule: issue.rule,            // keep rule separately\r\n  description: issue.description,\r\n  severity: issue.severity?.toLowerCase() || \"minor\",\r\n  line: issue.line,\r\n  autoFix: issue.autoFixable,\r\n  selected: false\r\n}));\r\n      setIssues(mapped);\r\n\r\n      const fileMap = {};\r\n      mapped.forEach(i => fileMap[i.file] = true);\r\n      setOpenFiles(fileMap);\r\n\r\n    } catch (err) {\r\n      console.error(\"Error fetching issues:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const toggleIssue = (id) => {\r\n  setIssues(prev =>\r\n    prev.map(issue =>\r\n      issue.id === id\r\n        ? { ...issue, selected: !issue.selected }\r\n        : issue\r\n    )\r\n  );\r\n};\r\n\r\n  /* ================= FETCH FILE ================= */\r\n\r\n  const openFile = async (filePath) => {\r\n    try {\r\n      const response = await axios.get(\r\n        `http://localhost:8080/api/files/${projectKey}`,\r\n        { params: { filePath } }\r\n      );\r\n\r\n      setFileContent(response.data);\r\n      setSelectedFile(filePath);\r\n\r\n    } catch (err) {\r\n      console.error(\"Failed to load file\", err);\r\n    }\r\n  };\r\n\r\n  /* ================= GROUP FILES ================= */\r\n\r\n  const files = [...new Set(issues.map(i => i.file))];\r\n\r\n  const getFileIssues = (filePath) =>\r\n    issues.filter(issue => issue.file === filePath);\r\n\r\n  const isFileFullySelected = (filePath) => {\r\n    const fileIssues = getFileIssues(filePath);\r\n    if (fileIssues.length === 0) return false;\r\n    return fileIssues.every(i => i.selected);\r\n  };\r\n\r\n  const toggleFileSelectAll = (filePath) => {\r\n    const fileIssues = getFileIssues(filePath);\r\n    const allSelected = fileIssues.every(i => i.selected);\r\n\r\n    setIssues(prev =>\r\n      prev.map(issue =>\r\n        issue.file === filePath\r\n          ? { ...issue, selected: !allSelected }\r\n          : issue\r\n      )\r\n    );\r\n  };\r\n\r\n  const toggleFileExpand = (filePath) => {\r\n    setOpenFiles(prev => ({\r\n      ...prev,\r\n      [filePath]: !prev[filePath]\r\n    }));\r\n  };\r\n\r\n  /* ================= AUTO FIX ================= */\r\n\r\n  const applySelected = async () => {\r\n    const selectedIssues = issues.filter(i => i.selected);\r\n    if (selectedIssues.length === 0) return toast.error(\"No issues selected\");\r\n\r\n    try {\r\n      await axios.post(\"http://localhost:8080/api/fix/apply\", {\r\n        issueKeys: selectedIssues.map(i => i.id),\r\n        projectKey\r\n      });\r\n      fetchIssues();\r\n    } catch (err) {\r\n      console.error(\"Auto-fix failed\", err);\r\n    }\r\n  };\r\n\r\n  const applyAll = async () => {\r\n    if (issues.length === 0) return toast.error(\"No issues to apply\");\r\n\r\n    try {\r\n      await axios.post(\"http://localhost:8080/api/fix/apply\", {\r\n        issueKeys: issues.map(i => i.id),\r\n        projectKey\r\n      });\r\n      fetchIssues();\r\n    } catch (err) {\r\n      console.error(\"Auto-fix all failed\", err);\r\n    }\r\n  };\r\nconst maskFilePath = (fullPath) => {\r\n  if (!fullPath) return \"\";\r\n\r\n  const parts = fullPath.split(\"/\");\r\n\r\n  if (parts.length <= 3) return fullPath; \r\n\r\n  const first = parts[0]; \r\n  const lastFolder = parts[parts.length - 2];\r\n  const fileName = parts[parts.length - 1];\r\n\r\n  return `${first}/../${lastFolder}/${fileName}`;\r\n};\r\n\r\n  const handleCopy = async () => {\r\n  if (!fileContent?.lines) return;\r\n\r\n  const fullText = fileContent.lines\r\n    .map(line =>\r\n      line.segments.map(segment => segment.text).join(\"\")\r\n    )\r\n    .join(\"\\n\");\r\n\r\n  try {\r\n    await navigator.clipboard.writeText(fullText);\r\n    toast.success(\"Copied to clipboard\");\r\n  } catch (err) {\r\n    toast.error(\"Copy failed\", err);\r\n  }\r\n};\r\n\r\nconst handleFullScreen = () => {\r\n  if (!editorRef.current) return;\r\n\r\n  if (!document.fullscreenElement) {\r\n    editorRef.current.requestFullscreen();\r\n  } else {\r\n    document.exitFullscreen();\r\n  }\r\n};\r\n\r\n  return (\r\n    <Box className=\"code-viewer-page\">\r\n\r\n      <Box className=\"code-viewer-nav\">\r\n        <Breadcrumbs separator={<ChevronRight size={14} color=\"#94a3b8\" />}>\r\n          <Link underline=\"hover\" color=\"#64748b\">Projects</Link>\r\n          <Link underline=\"hover\" color=\"#64748b\">{projectKey}</Link>\r\n          <Typography sx={{ fontSize: \"13px\", fontWeight: 600 }}>\r\n            Code Viewer\r\n          </Typography>\r\n        </Breadcrumbs>\r\n      </Box>\r\n\r\n      <main className=\"layout\">\r\n\r\n        {/* LEFT PANEL */}\r\n        <aside className=\"left-panel\">\r\n\r\n          <div className=\"left-header\">\r\n            <div className=\"left-title\">\r\n              <h3>TOTAL ISSUES</h3>\r\n              <span className=\"badge\">{issues.length} TOTAL</span>\r\n            </div>\r\n\r\n            <div className=\"controls\">\r\n              <div className=\"toggle-box\">\r\n                <span>Auto-Fixable Only</span>\r\n                <div\r\n                  className={`toggle ${autoFixOnly ? \"active\" : \"\"}`}\r\n                  onClick={() => setAutoFixOnly(prev => !prev)}\r\n                >\r\n                  <div className=\"toggle-dot\"></div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"btn-row\">\r\n                <button className=\"btn-outline\" onClick={applySelected}>\r\n                  Fix Selected\r\n                </button>\r\n                <button className=\"btn-primary\" onClick={applyAll}>\r\n                  Fix All\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"issue-list\">\r\n            {files.map(filePath => (\r\n              <div className=\"file-group\" key={filePath}>\r\n\r\n                <div\r\n                  className={`file-header ${selectedFile === filePath ? \"selected-file\" : \"\"}`}\r\n                  onClick={() => {\r\n                    if (selectedFile !== filePath) {\r\n                      openFile(filePath);\r\n                    }\r\n                  }}\r\n                >\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={isFileFullySelected(filePath)}\r\n                    onClick={(e) => e.stopPropagation()}\r\n                    onChange={() => toggleFileSelectAll(filePath)}\r\n                  />\r\n\r\n                  <span\r\n                    onClick={(e) => {\r\n                      e.stopPropagation();\r\n                      toggleFileExpand(filePath);\r\n                    }}\r\n                  >\r\n                    {openFiles[filePath] ? (\r\n                      <ChevronDown size={16} />\r\n                    ) : (\r\n                      <ChevronRight size={16} />\r\n                    )}\r\n                  </span>\r\n\r\n                  <FileText size={18} />\r\n                 <span className=\"file-name\">{maskFilePath(filePath)}</span>\r\n                </div>\r\n\r\n            {openFiles[filePath] &&\r\n  getFileIssues(filePath).map(issue => (\r\n    <div\r\n      key={issue.id}\r\n      className={`issue-item ${issue.selected ? \"active\" : \"\"}`}\r\n      onClick={() => {\r\n        openFile(issue.file);\r\n\r\n        setActiveIssueId(prev =>\r\n          prev === issue.id ? null : issue.id\r\n        );\r\n\r\n        setTimeout(() => {\r\n          const el = document.getElementById(`line-${issue.line}`);\r\n          if (el) {\r\n            el.scrollIntoView({\r\n              behavior: \"smooth\",\r\n              block: \"center\"\r\n            });\r\n          }\r\n        }, 300);\r\n      }}\r\n    >\r\n\r\n      \r\n    <input type=\"checkbox\" checked={issue.selected}\r\n      onChange={(e) => {\r\n      e.stopPropagation();\r\n      toggleIssue(issue.id);\r\n    }}\r\n    onClick={(e) => e.stopPropagation()}/>\r\n      <div className=\"issue-content\">\r\n        <div className=\"issue-top\">\r\n          <h4>{issue.message}</h4>\r\n          {issue.autoFix && <span className=\"auto\">AUTO</span>}\r\n        </div>\r\n\r\n        <p>{issue.title}</p>\r\n\r\n        <div className=\"issue-meta\">\r\n          <span className={issue.severity}>\r\n            {issue.severity.toUpperCase()}\r\n          </span>\r\n          <span className=\"line\">Line {issue.line}</span>\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n))}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </aside>\r\n\r\n        {/* CENTER PANEL */}\r\n        <section className=\"center-panel\" ref={editorRef}>\r\n\r\n          <div className=\"editor-header\">\r\n            <div className=\"editor-title\">\r\n              {selectedFile || \"Select a file\"}\r\n            </div>\r\n            <div className=\"editor-actions\">\r\n              <button onClick={handleCopy} className=\"icon-btn\">\r\n              <Copy size={18} />\r\n            </button>\r\n\r\n            <button onClick={handleFullScreen} className=\"icon-btn\">\r\n              <Maximize2 size={18} />\r\n            </button>\r\n           </div>\r\n          </div>\r\n\r\n <div className=\"editor-body\">\r\n  <div className=\"code-area\">\r\n    {fileContent?.lines?.map(line => {\r\n\r\n      const activeIssue = issues.find(\r\n        issue =>\r\n          issue.line === line.lineNumber &&\r\n          issue.id === activeIssueId\r\n      );\r\n\r\n      const hasActiveIssue = !!activeIssue;\r\n\r\n      return (\r\n        <React.Fragment key={line.lineNumber}>\r\n          <div\r\n            id={`line-${line.lineNumber}`}\r\n            className={`code-line ${hasActiveIssue ? \"highlight-line\" : \"\"}`}\r\n          >\r\n            <span>{line.lineNumber}</span>\r\n\r\n            {line.segments.map((segment, idx) => (\r\n              <span\r\n                key={idx}\r\n                className={segment.highlighted ? \"highlight\" : \"\"}\r\n              >\r\n                {segment.text}\r\n              </span>\r\n            ))}\r\n          </div>\r\n\r\n          {hasActiveIssue && (\r\n            <div className=\"issue-popup-row\">\r\n              <div className=\"popup\">\r\n                <div className=\"popup-icon\">\r\n                  <AlertCircle size={16} />\r\n                </div>\r\n                <div>\r\n                  <h4>{activeIssue.title}</h4>\r\n                  <p className=\"popup-sub\">\r\n                    {activeIssue.severity.toUpperCase()}\r\n                  </p>\r\n                  \r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </React.Fragment>\r\n      );\r\n    })}\r\n  </div>\r\n</div>\r\n        </section>\r\n\r\n      </main>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default CodeViewer;\r\n"
        }
    ]
}